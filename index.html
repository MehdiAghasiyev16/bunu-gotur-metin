<!doctype html>
<html lang="az">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arena9</title>
    <style>
      :root {
        --bg-black: #0a0a0a;
        --bg-dark: #121212;
        --card-gray: #1e1e1e;
        --card-hover: #252525;
        --primary-green: #10b981;
        --primary-green-light: #34d399;
        --text-gray: #9ca3af;
        --text-light: #e5e7eb;
        --danger-red: #ef4444;
        --gold: #fbbf24;
        --success: #10b981;
        --warning: #f97316;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap");

      * {
        box-sizing: border-box;
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          sans-serif;
        transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      body {
        background: linear-gradient(
          135deg,
          var(--bg-black) 0%,
          var(--bg-dark) 100%
        );
        color: var(--text-light);
        margin: 0;
        padding: 0;
        overflow-y: auto;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      header {
        padding: 24px 28px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
        background: linear-gradient(
          180deg,
          var(--card-gray) 0%,
          var(--bg-dark) 100%
        );
        border-bottom: 1px solid rgba(16, 185, 129, 0.1);
        box-shadow: var(--shadow-sm);
        backdrop-filter: blur(10px);
      }

      .header-left {
        position: absolute;
        left: 28px;
        display: flex;
        align-items: center;
        gap: 12px;
        z-index: 10;
      }

      .header-right {
        position: absolute;
        right: 28px;
        display: flex;
        align-items: center;
        gap: 12px;
        z-index: 10;
      }

      .header-logo {
        font-size: 32px;
        font-weight: 800;
        color: var(--primary-green);
        letter-spacing: -0.5px;
      }

      .header-subtitle {
        font-size: 11px;
        color: var(--text-gray);
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      #page-header-title {
        font-weight: 700;
        font-size: 20px;
        text-align: center;
        letter-spacing: -0.5px;
        background: linear-gradient(
          135deg,
          var(--primary-green),
          var(--primary-green-light)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        max-width: calc(100vw - 240px);
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
      }
      .header-icon {
        font-size: 24px;
        width: 48px;
        height: 40px;
        cursor: pointer;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        background: rgba(16, 185, 129, 0.1);
        border: 1px solid rgba(16, 185, 129, 0.2);
        transition: all 0.3s ease;
      }

      .header-icon:hover {
        background: rgba(16, 185, 129, 0.2);
        transform: scale(1.05);
      }
      .page-container {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        padding-bottom: 80px;
      }
      .page {
        display: none;
      }
      .active-page {
        display: block;
      }
      .stat-card,
      .match-card {
        background: var(--card-gray);
        border-radius: 12px;
        padding: 16px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        margin-bottom: 12px;
        position: relative;
        box-shadow: var(--shadow-sm);
        backdrop-filter: blur(10px);
      }

      .stat-card:hover {
        background: var(--card-hover);
        border-color: rgba(16, 185, 129, 0.2);
      }

      .match-card {
        border-left: 3px solid var(--primary-green);
        cursor: pointer;
      }

      .match-card:hover {
        background: var(--card-hover);
        transform: translateY(-2px);
        box-shadow: 0 12px 24px rgba(16, 185, 129, 0.1);
      }
      .match-details {
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid #333;
        font-size: 13px;
        color: #ccc;
        display: none;
      }
      .match-card.expanded .match-details {
        display: block;
      }
      .match-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 10px;
        padding-top: 5px;
        border-top: 1px solid #222;
      }
      .match-date-info {
        font-size: 10px;
        color: #666;
      }
      .delete-btn {
        color: var(--danger-red);
        font-size: 12px;
        padding: 4px 8px;
        border-radius: 5px;
        background: rgba(255, 77, 77, 0.1);
        border: none;
        cursor: pointer;
      }
      .rank-item {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        padding: 14px;
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.05),
          transparent
        );
        border-radius: 10px;
        margin-bottom: 8px;
        border-left: 3px solid var(--primary-green);
        border: 1px solid rgba(16, 185, 129, 0.1);
        border-left: 3px solid var(--primary-green);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .rank-item:hover {
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.1),
          rgba(16, 185, 129, 0.05)
        );
        border-color: rgba(16, 185, 129, 0.3);
        transform: translateX(4px);
      }
      .rank-num {
        color: var(--primary-green);
        font-weight: 700;
        width: 40px;
        font-size: 16px;
      }
      .rating-box {
        grid-column: span 2;
        text-align: center;
        padding: 24px;
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.1) 0%,
          rgba(52, 211, 153, 0.05) 100%
        );
        border: 2px solid rgba(16, 185, 129, 0.3);
        border-radius: 14px;
        box-shadow: var(--shadow-sm);
      }
      .rating-value {
        font-size: 48px;
        font-weight: 800;
        background: linear-gradient(
          135deg,
          var(--primary-green),
          var(--primary-green-light)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        letter-spacing: -2px;
      }
      .season-table {
        grid-column: span 2;
        background: var(--card-gray);
        border-radius: 15px;
        overflow: hidden;
        border: 1px solid #222;
        margin-bottom: 15px;
      }
      .table-title {
        font-size: 11px;
        color: #fff;
        background: #222;
        padding: 10px 15px;
        text-align: left;
        text-transform: uppercase;
        font-weight: bold;
        border-bottom: 1px solid var(--primary-green);
      }
      .season-table table {
        width: 100%;
        border-collapse: collapse;
        font-size: 12px;
      }
      .season-table th {
        background: #111;
        color: var(--text-gray);
        padding: 10px;
        text-align: center;
        font-size: 10px;
      }
      .season-table td {
        padding: 12px 10px;
        border-top: 1px solid #222;
        color: #eee;
        text-align: center;
      }
      .season-table th:first-child,
      .season-table td:first-child {
        text-align: left;
        padding-left: 15px;
        width: 40%;
        color: var(--primary-green);
        font-weight: bold;
      }
      .form-group {
        margin-bottom: 12px;
      }
      label {
        display: block;
        font-size: 11px;
        color: var(--primary-green);
        margin-bottom: 6px;
        text-transform: uppercase;
        font-weight: 600;
        letter-spacing: 0.5px;
      }
      input,
      select {
        width: 100%;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: var(--text-light);
        padding: 12px;
        border-radius: 8px;
        outline: none;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      input:hover,
      select:hover {
        border-color: rgba(16, 185, 129, 0.2);
        background: rgba(255, 255, 255, 0.08);
      }

      input:focus,
      select:focus {
        border-color: var(--primary-green);
        background: rgba(16, 185, 129, 0.05);
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      option {
        background: rgba(255, 255, 255, 0.1);
        color: #000;
        padding: 8px;
      }
      .edit-grid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 5px;
        margin-bottom: 15px;
        background: #111;
        padding: 10px;
        border-radius: 10px;
      }
      .main-btn {
        background: linear-gradient(
          135deg,
          var(--primary-green) 0%,
          var(--primary-green-light) 100%
        );
        color: #000;
        border: none;
        padding: 14px;
        width: 100%;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 10px;
        font-size: 14px;
        letter-spacing: 0.5px;
        box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        transition: all 0.3s ease;
      }

      .main-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
      }

      .main-btn:active {
        transform: translateY(0);
      }
      footer {
        background: linear-gradient(
          180deg,
          var(--bg-dark) 0%,
          var(--card-gray) 100%
        );
        display: flex;
        padding: 12px 0;
        border-top: 1px solid rgba(16, 185, 129, 0.1);
        position: fixed;
        bottom: 0;
        width: 100%;
        z-index: 100;
        box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.3);
      }
      .nav-item {
        flex: 1;
        text-align: center;
        color: var(--text-gray);
        font-size: 10px;
        cursor: pointer;
        padding: 8px 4px;
        border-radius: 8px;
        margin: 2px;
        transition: all 0.3s ease;
      }

      .nav-item:hover {
        background: rgba(16, 185, 129, 0.1);
        color: var(--primary-green-light);
      }
      .nav-item.active {
        color: var(--primary-green);
        background: rgba(16, 185, 129, 0.15);
      }
      .nav-icon {
        font-size: 20px;
        display: block;
        margin-bottom: 2px;
      }
      .stat-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      .single-stat {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 80px;
      }
      .tab-btn {
        flex: 1;
        padding: 10px 5px;
        border-radius: 8px;
        border: 1px solid var(--primary-green);
        background: transparent;
        color: var(--primary-green);
        cursor: pointer;
        font-size: 11px;
      }
      .tab-btn.active {
        background: var(--primary-green) !important;
        color: #000 !important;
      }

      .player-picker.active {
        display: flex;
      }

      .player-picker-header {
        font-weight: bold;
        font-size: 18px;
        margin-bottom: 15px;
        color: var(--primary-green);
      }

      .player-picker-item {
        background: var(--card-gray);
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 12px;
        cursor: pointer;
        border: 1px solid #222;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .player-picker-item:hover {
        border-color: var(--primary-green);
        background: #252525;
      }

      .player-picker-name {
        font-weight: bold;
      }

      .player-picker-rating {
        color: var(--primary-green);
        font-size: 14px;
        font-weight: bold;
      }

      .toast {
        position: fixed;
        bottom: 100px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--card-gray);
        color: var(--text-light);
        padding: 14px 24px;
        border-radius: 10px;
        border-left: 4px solid var(--primary-green);
        z-index: 2000;
        animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--shadow);
        font-weight: 500;
        font-size: 13px;
        max-width: 80%;
      }

      .toast.error {
        border-left-color: var(--danger-red);
        background: rgba(239, 68, 68, 0.1);
        color: #fca5a5;
      }

      .toast.success {
        border-left-color: var(--success);
        background: rgba(16, 185, 129, 0.1);
        color: #86efac;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateX(-50%) translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
      }

      .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: #666;
      }

      .empty-state-icon {
        font-size: 48px;
        margin-bottom: 15px;
        opacity: 0.5;
      }

      .empty-state-text {
        font-size: 14px;
        color: #888;
      }

      .btn-secondary {
        background: #333;
        color: #fff;
        border: 1px solid #444;
        padding: 10px 15px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 12px;
        font-weight: bold;
      }

      .btn-secondary:hover {
        background: #444;
        border-color: var(--primary-green);
      }

      .btn-danger {
        background: rgba(255, 77, 77, 0.1);
        color: var(--danger-red);
        border: 1px solid var(--danger-red);
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 11px;
        font-weight: bold;
      }

      .btn-danger:hover {
        background: rgba(255, 77, 77, 0.2);
      }

      input:invalid {
        border-color: var(--danger-red) !important;
      }

      .stat-badge {
        display: inline-block;
        background: #333;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        color: var(--primary-green);
        font-weight: bold;
        margin: 2px;
      }

      .loading {
        display: inline-block;
        width: 12px;
        height: 12px;
        background: var(--primary-green);
        border-radius: 50%;
        animation: pulse 1.5s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      .divider {
        height: 1px;
        background: #222;
        margin: 15px 0;
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }

      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1500;
      }

      .modal-overlay.active {
        display: flex;
      }

      .modal-content {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 15px;
        padding: 25px;
        max-width: 400px;
        width: 90%;
        text-align: center;
      }

      .modal-title {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 15px;
        color: var(--primary-green);
      }

      .modal-text {
        color: #ccc;
        margin-bottom: 20px;
        font-size: 14px;
      }

      .modal-buttons {
        display: flex;
        gap: 10px;
        justify-content: center;
      }

      .modal-btn {
        padding: 10px 20px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        font-weight: bold;
        font-size: 12px;
      }

      .modal-btn.primary {
        background: var(--primary-green);
        color: #000;
      }

      .modal-btn.secondary {
        background: #333;
        color: #fff;
        border: 1px solid #444;
      }

      .player-select {
        width: 120px;
        height: 120px;
        border: 2px dashed rgba(16, 185, 129, 0.5);
        border-radius: 8px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        background: rgba(16, 185, 129, 0.05);
      }

      .player-select:hover {
        border-color: var(--primary-green);
        background: rgba(16, 185, 129, 0.1);
      }

      .select-icon {
        font-size: 32px;
        color: var(--primary-green);
        font-weight: bold;
      }

      .select-text {
        font-size: 12px;
        color: var(--text-gray);
        margin-top: 5px;
      }

      .vs-text {
        font-size: 24px;
        font-weight: bold;
        color: var(--primary-green);
      }

      .comparison-grid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 20px;
        max-width: 800px;
        margin: 0 auto;
      }

      .stat-names {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .player-stats {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .stat-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: var(--card-gray);
        border-radius: 8px;
        font-size: 14px;
      }

      .stat-value {
        font-weight: bold;
        color: var(--text-light);
      }

      .stat-diff {
        color: var(--primary-green);
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-left">
        <span class="header-logo">‚öΩ Arena9</span>
        <span
          id="back-header-btn"
          class="header-icon"
          style="visibility: hidden"
          onclick="goBack()"
          title="Geri"
          >‚Üê</span
        >
      </div>
      <span id="page-header-title">∆èsas</span>
      <div class="header-right">
        <button
          id="edit-header-btn"
          class="header-icon"
          style="
            visibility: hidden;
            border: none;
            background: none;
            color: inherit;
            cursor: pointer;
          "
          onclick="toggleEdit()"
          title="Redakt…ô et"
        >
          ‚úèÔ∏è
        </button>
      </div>
    </header>

    <div class="page-container">
      <div id="ana-sayfa" class="page active-page">
        <!-- Recent Matches Section -->
        <div
          style="
            background: var(--card-gray);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 24px;
          "
        >
          <h3
            style="
              color: var(--primary-green);
              margin: 0 0 16px 0;
              font-size: 18px;
              font-weight: 600;
            "
          >
            ‚öΩ Son Mat√ßlar
          </h3>
          <div id="recent-matches-list"></div>
        </div>

        <!-- Top Rankings Section -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px">
          <!-- Top Goals -->
          <div
            style="
              background: var(--card-gray);
              padding: 20px;
              border-radius: 12px;
              box-shadow: var(--shadow-sm);
            "
          >
            <h3
              style="
                color: var(--primary-green);
                margin: 0 0 16px 0;
                font-size: 18px;
                font-weight: 600;
              "
            >
              ü•Ö Qol Krallƒ±ƒüƒ± (Top 5)
            </h3>
            <div id="top-goals-list"></div>
          </div>

          <!-- Top Assists -->
          <div
            style="
              background: var(--card-gray);
              padding: 20px;
              border-radius: 12px;
              box-shadow: var(--shadow-sm);
            "
          >
            <h3
              style="
                color: var(--primary-green);
                margin: 0 0 16px 0;
                font-size: 18px;
                font-weight: 600;
              "
            >
              üéØ Asist Krallƒ±ƒüƒ± (Top 5)
            </h3>
            <div id="top-assists-list"></div>
          </div>
        </div>
      </div>

      <div id="maclar" class="page">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
          "
        >
          <h2>Mat√ß Tarix√ß…ôsi</h2>
          <button
            onclick="showMatchForm()"
            style="
              background: var(--primary-green);
              color: #000;
              border: none;
              padding: 8px 15px;
              border-radius: 8px;
              font-weight: bold;
            "
          >
            + Yeni Mat√ß
          </button>
        </div>
        <div id="match-list"></div>
      </div>

      <div id="oyuncular" class="page">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
          "
        >
          <h2>Oyun√ßular</h2>
          <button
            onclick="showAddPlayerForm()"
            style="
              background: linear-gradient(
                135deg,
                var(--primary-green),
                var(--primary-green-light)
              );
              color: #000;
              border: none;
              padding: 10px 16px;
              border-radius: 8px;
              font-weight: 600;
              cursor: pointer;
              font-size: 13px;
            "
          >
            + Yeni Oyun√ßu
          </button>
        </div>
        <div style="margin-bottom: 15px">
          <input
            type="text"
            id="player-search"
            placeholder="üîç Oyun√ßu ara..."
            oninput="filterPlayers(this.value)"
            style="font-size: 13px"
          />
        </div>
        <div id="full-player-list"></div>
      </div>

      <div id="add-player-page" class="page">
        <div class="form-group">
          <label>Oyun√ßu Adƒ±</label
          ><input
            type="text"
            id="new-p-name"
            placeholder=" "
          />
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px">
          <div class="form-group">
            <label>N√∂mr…ô</label
            ><input type="text" id="new-p-num" placeholder="7" />
          </div>
          <div class="form-group">
            <label>Ya≈ü</label><input type="number" id="new-p-age" value="14" />
          </div>
        </div>

        <h3
          style="
            color: var(--primary-green);
            font-size: 14px;
            margin: 15px 0 10px 0;
          "
        >
          TEXNƒ∞Kƒ∞ G√ñST∆èRƒ∞Cƒ∞L∆èR (0-99)
        </h3>
        <div
          id="new-p-stats-container"
          style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px"
        ></div>

        <button class="main-btn" onclick="saveNewPlayer()">
          OYUN√áUNU YADDA SAXLA
        </button>
      </div>

      <div id="istatistikler" class="page">
        <div
          class="tab-container"
          style="display: flex; gap: 5px; margin-bottom: 20px"
        >
          <button
            class="tab-btn active"
            id="btn-gol"
            onclick="showStats('gol')"
          >
            Qol
          </button>
          <button class="tab-btn" id="btn-asist" onclick="showStats('asist')">
            Asist
          </button>
          <button class="tab-btn" id="btn-motm" onclick="showStats('motm')">
            MOTM
          </button>
        </div>
        <div id="stats-list"></div>
      </div>

      <div id="muqayise" class="page">
        <h2>M√ºqayis…ô</h2>
        <div
          style="
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
          "
        >
          <div
            id="player1-select"
            class="player-select"
            onclick="selectPlayer(1)"
          >
            <div class="select-icon">+</div>
            <div class="select-text">Oyuncu Se√ß</div>
          </div>
          <div class="vs-text">VS</div>
          <div
            id="player2-select"
            class="player-select"
            onclick="selectPlayer(2)"
          >
            <div class="select-icon">+</div>
            <div class="select-text">Oyuncu Se√ß</div>
          </div>
        </div>
        <div id="comparison-content" style="display: none">
          <div class="comparison-grid">
            <div class="player-stats" id="player1-stats"></div>
            <div class="stat-names"></div>
            <div class="player-stats" id="player2-stats"></div>
          </div>
        </div>
      </div>

      <div id="add-match-page" class="page">
        <h2>Yeni Mat√ß ∆èlav…ô Et</h2>
        <div class="form-group">
          <label>Mat√ß N√∂v√º</label>
          <select id="m_type">
            <option value="Sinif Ligi">Sinif Ligi</option>
            <option value="Dostluq mat√ßlarƒ±">Dostluq mat√ßlarƒ±</option>
            <option value="M…ôkt…ôbd…ônk…ônar">M…ôkt…ôbd…ônk…ônar</option>
            <option value="M…ôkt…ôb √ßempionatƒ±">M…ôkt…ôb √ßempionatƒ±</option>
          </select>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px">
          <div class="form-group">
            <label>Ev Sahibi</label
            ><input
              type="text"
              id="m_home_team"
              value="Arena9"
              oninput="updateTeamOptions()"
            />
          </div>
          <div class="form-group">
            <label>Qonaq</label
            ><input
              type="text"
              id="m_away_team"
              placeholder="R…ôqib"
              oninput="updateTeamOptions()"
            />
          </div>
        </div>
        <div style="display: flex; gap: 10px">
          <div style="flex: 1">
            <label>Tarix</label><input type="datetime-local" id="m_date_time" />
          </div>
          <div style="flex: 1">
            <label>Sezon</label>
            <select id="m_season">
              <option value="21/22">21/22</option>
              <option value="22/23">22/23</option>
              <option value="23/24">23/24</option>
              <option value="24/25">24/25</option>
              <option value="25/26">25/26</option>
            </select>
          </div>
        </div>
        <div
          style="
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            background: #111;
            padding: 15px;
            border-radius: 15px;
          "
        >
          <div style="text-align: center">
            <small
              id="live-name-1"
              style="color: #888; display: block; margin-bottom: 5px"
              >Ev</small
            ><span
              id="live-s1"
              style="
                font-size: 32px;
                font-weight: bold;
                color: var(--primary-green);
              "
              >0</span
            >
          </div>
          <div style="font-size: 24px; color: #444">-</div>
          <div style="text-align: center">
            <small
              id="live-name-2"
              style="color: #888; display: block; margin-bottom: 5px"
              >Qonaq</small
            ><span
              id="live-s2"
              style="
                font-size: 32px;
                font-weight: bold;
                color: var(--primary-green);
              "
              >0</span
            >
          </div>
        </div>
        <div
          style="
            background: #0f0f0f;
            padding: 15px;
            border-radius: 15px;
            border: 1px solid #222;
          "
        >
          <div class="form-group">
            <label>Qolu Vuran Komanda</label
            ><select id="event_scoring_team"></select>
          </div>
          <div class="form-group">
            <label>Oyun√ßu</label>
            <input
              type="text"
              id="event_player_manual"
              placeholder="Oyun√ßu adƒ±..."
              list="player-datalist"
            />
            <datalist id="player-datalist"></datalist>
          </div>
          <div class="form-group">
            <label>Asist</label
            ><input
              type="text"
              id="event_assist_manual"
              placeholder="Asist ed…ôn..."
              list="player-datalist"
            />
          </div>
          <button
            class="main-btn"
            onclick="addMatchEvent('goal')"
            style="
              background: #333;
              color: var(--primary-green);
              border: 1px dashed var(--primary-green);
            "
          >
            ‚öΩ Qol ∆èlav…ô Et
          </button>
        </div>
        <div class="form-group" style="margin-top: 15px">
          <label style="color: var(--gold)">‚≠ê MOTM</label
          ><select id="match_motm"></select>
        </div>
        <div
          id="temp_event_list"
          style="font-size: 12px; color: #aaa; margin: 10px 0"
        ></div>
        <button class="main-btn" onclick="saveMatch()">
          MAT√áI YADDA SAXLA
        </button>
      </div>

      <div id="player-profile" class="page">
        <div id="profile-details" class="stat-grid"></div>
      </div>

      <div id="edit-page" class="page">
        <div id="edit-form-container"></div>
        <h3
          style="color: var(--primary-green); font-size: 14px; margin-top: 20px"
        >
          SEZON STATƒ∞STƒ∞KASINI D√úZ∆èLT
        </h3>
        <div id="past-seasons-edit"></div>
        <h3
          style="color: var(--primary-green); font-size: 14px; margin-top: 20px"
        >
          MAT√á N√ñVL∆èRƒ∞Nƒ∞ D√úZ∆èLT
        </h3>
        <div id="match-types-edit"></div>
        <button class="main-btn" onclick="savePlayerStats()">
          Yadda Saxla
        </button>
      </div>
    </div>

    <footer>
      <div
        class="nav-item active"
        id="nav-ana-sayfa"
        onclick="changePage('ana-sayfa', '∆èsas')"
      >
        <span class="nav-icon">üè†</span>∆èsas
      </div>
      <div
        class="nav-item"
        id="nav-maclar"
        onclick="changePage('maclar', 'Mat√ßlar')"
      >
        <span class="nav-icon">‚öΩ</span>Mat√ßlar
      </div>
      <div
        class="nav-item"
        id="nav-oyuncular"
        onclick="changePage('oyuncular', 'Oyun√ßular')"
      >
        <span class="nav-icon">üë•</span>Oyun√ßular
      </div>
      <div
        class="nav-item"
        id="nav-istatistikler"
        onclick="changePage('istatistikler', 'ƒ∞statistikler')"
      >
        <span class="nav-icon">üìä</span>ƒ∞statistikler
      </div>
      <div
        class="nav-item"
        id="nav-muqayise"
        onclick="changePage('muqayise', 'M√ºqayis…ô')"
      >
        <span class="nav-icon">‚öñÔ∏è</span>M√ºqayis…ô
      </div>
    </footer>

    <div id="confirm-modal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-title">T…ôsdiq</div>
        <div class="modal-text" id="confirm-text"></div>
        <div class="modal-buttons">
          <button class="modal-btn secondary" onclick="closeConfirmModal()">
            L…ôƒüv Et
          </button>
          <button class="modal-btn primary" onclick="confirmAction()">
            B…ôli
          </button>
        </div>
      </div>
    </div>

    <script>
      const statNames = [
        "Qol",
        "Asist",
        "Hƒ±z",
        "≈ûut",
        "Pas",
        "Dribling",
        "Defans",
        "Fizik",
      ];
      const matchTypes = [
        "Sinif Ligi",
        "Dostluq mat√ßlarƒ±",
        "M…ôkt…ôbd…ônk…ônar",
        "M…ôkt…ôb √ßempionatƒ±",
      ];
      const seasonOptions = ["21/22", "22/23", "23/24", "24/25", "25/26"];

      let players = JSON.parse(localStorage.getItem("arena9_players")) || [];
      let matches = JSON.parse(localStorage.getItem("arena9_matches")) || [];
      let tempEvents = [];
      let s1 = 0,
        s2 = 0;
      let currentPlayerIndex = null;
      let historyStack = ["ana-sayfa"];
      let compareLeft = null;
      let compareRight = null;
      let currentCompareSide = null;
      let isEditMode = false;
      let currentPage = "ana-sayfa";

      // Toast Notification
      function showToast(message, type = "success") {
        const toast = document.createElement("div");
        toast.className = `toast ${type}`;
        toast.innerText = message;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      }

      // Confirm Modal
      function showConfirm(message, callback) {
        document.getElementById("confirm-text").innerText = message;
        document.getElementById("confirm-modal").classList.add("active");
        pendingAction = callback;
      }

      function confirmAction() {
        if (pendingAction) pendingAction();
        closeConfirmModal();
      }

      function closeConfirmModal() {
        document.getElementById("confirm-modal").classList.remove("active");
        pendingAction = null;
      }

      // Form Validation
      function validatePlayerForm() {
        const name = document.getElementById("new-p-name").value.trim();
        const age = document.getElementById("new-p-age").value;

        if (!name) {
          showToast("Oyun√ßu adƒ± bo≈ü ola bilm…ôz!", "error");
          return false;
        }
        if (name.length < 2) {
          showToast("Ad …ôn az 2 h…ôrfd…ôn ibar…ôt olmalƒ±dƒ±r!", "error");
          return false;
        }
        if (age < 10 || age > 50) {
          showToast("Ya≈ü 10 il…ô 50 arasƒ±nda olmalƒ±dƒ±r!", "error");
          return false;
        }
        return true;
      }

      function validateMatchForm() {
        const homeTeam = document.getElementById("m_home_team").value.trim();
        const awayTeam = document.getElementById("m_away_team").value.trim();
        const date = document.getElementById("m_date_time").value;

        if (!homeTeam || !awayTeam) {
          showToast("Ev sahibi v…ô qonaq adlarƒ±nƒ± daxil edin!", "error");
          return false;
        }
        if (homeTeam === awayTeam) {
          showToast("Komandalar eyni ola bilm…ôz!", "error");
          return false;
        }
        if (!date) {
          showToast("Mat√ß tarixini se√ßin!", "error");
          return false;
        }
        return true;
      }

      function changePage(pageId, title) {
        currentPage = pageId;
        document
          .querySelectorAll(".page")
          .forEach((p) => p.classList.remove("active-page"));
        document.getElementById(pageId).classList.add("active-page");
        document.getElementById("page-header-title").innerText = title;
        document
          .querySelectorAll(".nav-item")
          .forEach((i) => i.classList.remove("active"));

        let navId = "";
        if (pageId === "ana-sayfa") navId = "nav-ana-sayfa";
        else if (pageId === "maclar" || pageId === "add-match-page")
          navId = "nav-maclar";
        else if (
          pageId === "oyuncular" ||
          pageId === "player-profile" ||
          pageId === "edit-page" ||
          pageId === "add-player-page"
        )
          navId = "nav-oyuncular";
        else if (pageId === "istatistikler") navId = "nav-istatistikler";
        else if (pageId === "muqayise") navId = "nav-muqayise";

        if (navId) document.getElementById(navId).classList.add("active");
        document.getElementById("edit-header-btn").style.visibility =
          pageId === "player-profile" ||
          pageId === "maclar" ||
          pageId === "oyuncular"
            ? "visible"
            : "hidden";
        if (pageId === "player-profile") {
          document.getElementById("edit-header-btn").innerHTML = "‚úèÔ∏è";
          document.getElementById("edit-header-btn").title = "Redakt…ô et";
        } else if (pageId === "maclar") {
          document.getElementById("edit-header-btn").innerHTML = "+";
          document.getElementById("edit-header-btn").title = "Yeni Mat√ß";
        } else if (pageId === "oyuncular") {
          document.getElementById("edit-header-btn").innerHTML = "+";
          document.getElementById("edit-header-btn").title = "Yeni Oyun√ßu";
        }
        document.getElementById("back-header-btn").style.visibility =
          pageId === "player-profile" ||
          pageId === "edit-page" ||
          pageId === "add-match-page" ||
          pageId === "maclar"
            ? "visible"
            : "hidden";

        if (pageId === "ana-sayfa") {
          renderRecentMatches();
          renderTopGoals();
          renderTopAssists();
        }
        if (pageId === "istatistikler") showStats("gol");
        if (pageId === "maclar") renderMatches();
        if (pageId === "oyuncular") {
          renderPlayers();
          document.getElementById("player-search").value = "";
        }
        if (pageId === "add-player-page") renderAddPlayerStats();
        if (pageId === "muqayise") renderComparison();

        if (historyStack[historyStack.length - 1] !== pageId)
          historyStack.push(pageId);
      }

      function exportData() {
        const data = {
          players,
          matches,
          exportedAt: new Date().toLocaleString("az-AZ"),
        };

        const json = JSON.stringify(data, null, 2);
        const blob = new Blob([json], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `Arena9_${new Date().toISOString().split("T")[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
        showToast("M…ôlumatlar y√ºkl…ôndi ‚úì", "success");
      }

      function goBack() {
        if (historyStack.length > 1) {
          historyStack.pop();
          let prev = historyStack[historyStack.length - 1];
          let title = getPageTitle(prev);
          changePage(prev, title);
        }
      }

      function getPageTitle(pageId) {
        switch (pageId) {
          case "ana-sayfa":
            return "∆èsas";
          case "maclar":
            return "Mat√ßlar";
          case "oyuncular":
            return "Oyun√ßular";
          case "istatistikler":
            return "ƒ∞statistikler";
          case "muqayise":
            return "M√ºqayis…ô";
          case "player-profile":
            return players[currentPlayerIndex]?.name || "Oyuncu";
          case "edit-page":
            return "Redakt…ô";
          case "add-player-page":
            return "Yeni Oyun√ßu";
          case "add-match-page":
            return "Yeni Mat√ß";
          default:
            return "∆èsas";
        }
      }

      function renderAddPlayerStats() {
        const container = document.getElementById("new-p-stats-container");
        container.innerHTML = statNames
          .map(
            (s) => `
                <div class="form-group">
                  <label>${s}</label>
                  <input type="number" id="new-stat-${s}" value="80" min="0" max="99">
                </div>
              `,
          )
          .join("");
      }

      function saveNewPlayer() {
        if (!validatePlayerForm()) return;

        const name = document.getElementById("new-p-name").value.trim();
        const num = document.getElementById("new-p-num").value || "0";
        const age = parseInt(document.getElementById("new-p-age").value) || 14;

        // Oyun√ßunun zaten var olup olmadƒ±ƒüƒ±nƒ± kontrol et
        if (players.some((p) => p.name.toLowerCase() === name.toLowerCase())) {
          showToast("Bu oyun√ßu zaten m√∂vcuddur!", "error");
          return;
        }

        let customStats = {};
        statNames.forEach((s) => {
          const val =
            parseInt(document.getElementById(`new-stat-${s}`).value) || 80;
          customStats[s] = Math.max(0, Math.min(99, val));
        });

        const newPlayer = {
          num: num,
          name: name,
          age: age,
          stats: customStats,
          pastData: createPastData(),
          typeStats: createTypeStats(),
        };

        players.push(newPlayer);
        localStorage.setItem("arena9_players", JSON.stringify(players));

        showToast(name + " uƒüurla …ôlav…ô edildi! ‚úì", "success");
        document.getElementById("new-p-name").value = "";
        document.getElementById("new-p-num").value = "";
        document.getElementById("new-p-age").value = "14";
        changePage("oyuncular", "Oyun√ßular");
      }

      function createPastData() {
        let d = {};
        seasonOptions.forEach((s) => (d[s] = { g: 0, a: 0, m: 0 }));
        return d;
      }
      function createTypeStats() {
        let d = {};
        matchTypes.forEach((t) => (d[t] = { g: 0, a: 0, m: 0 }));
        return d;
      }

      function getOverall(stats) {
        let t = 0;
        statNames.forEach((n) => (t += Number(stats[n])));
        return Math.round(t / statNames.length);
      }

      function renderPlayers() {
        const list = document.getElementById("full-player-list");

        if (players.length === 0) {
          list.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">üë•</div>
              <div class="empty-state-text">H…ôl…ô oyun√ßu yoxdur</div>
              <div style="margin-top: 15px;">
                <button class="main-btn" style="max-width: 200px; margin: 0 auto;" onclick="showAddPlayerForm()">
                  + Oyun√ßu ∆èlav…ô Et
                </button>
              </div>
            </div>
          `;
          return;
        }

        players.sort((a, b) => a.num - b.num);
        list.innerHTML = players
          .map(
            (p, idx) => `
                <div class="rank-item" style="position: relative;">
                  <span class="rank-num">#${p.num}</span>
                  <div style="flex:1; cursor: pointer;" onclick="viewProfile(${idx})">
                    <div style="font-weight:600; font-size: 14px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${p.name}</div>
                    <div style="font-size:11px; color:var(--text-gray); margin-top: 2px;">OVR: <span style="color: var(--primary-green); font-weight: 600;">${getOverall(p.stats)}</span> | Ya≈ü: ${p.age}</div>
                  </div>
                  <button class="btn-danger" onclick="deletePlayer(${idx})" title="Sil">üóëÔ∏è</button>
                </div>
              `,
          )
          .join("");
      }

      function filterPlayers(query) {
        const list = document.getElementById("full-player-list");
        const filtered = players.filter(
          (p) =>
            p.name.toLowerCase().includes(query.toLowerCase()) ||
            p.num.toString().includes(query),
        );

        if (filtered.length === 0) {
          list.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">üîç</div>
              <div class="empty-state-text">Oyun√ßu tapƒ±lmadƒ±</div>
            </div>
          `;
          return;
        }

        list.innerHTML = filtered
          .map((p, idx) => {
            const actualIdx = players.indexOf(p);
            return `
                <div class="rank-item" style="position: relative;">
                  <span class="rank-num">#${p.num}</span>
                  <div style="flex:1; cursor: pointer;" onclick="viewProfile(${actualIdx})">
                    <div style="font-weight:600; font-size: 14px;">${p.name}</div>
                    <div style="font-size:11px; color:var(--text-gray); margin-top: 2px;">OVR: <span style="color: var(--primary-green); font-weight: 600;">${getOverall(p.stats)}</span> | Ya≈ü: ${p.age}</div>
                  </div>
                  <button class="btn-danger" onclick="deletePlayer(${actualIdx})" title="Sil">üóëÔ∏è</button>
                </div>
              `;
          })
          .join("");
      }

      function deletePlayer(idx) {
        const player = players[idx];
        showConfirm(
          `${player.name} silinsin?\nBu …ôm…ôl geri qaytarƒ±la bilm…ôz.`,
          () => {
            players.splice(idx, 1);
            localStorage.setItem("arena9_players", JSON.stringify(players));
            showToast(player.name + " silindi", "success");
            renderPlayers();
          },
        );
      }

      function renderRecentMatches() {
        const list = document.getElementById("recent-matches-list");
        if (matches.length === 0) {
          list.innerHTML =
            '<div style="text-align: center; color: var(--text-gray); padding: 20px;">H…ôl…ô mat√ß yoxdur</div>';
          return;
        }
        const recent = matches.slice(0, 5); // Show last 5 matches
        list.innerHTML = recent
          .map(
            (m, idx) => `
                <div class="match-card" onclick="viewMatch(${matches.indexOf(m)})" style="cursor: pointer; margin-bottom: 8px;">
                  <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                      <small style="color:var(--primary-green)">${m.type} (${m.season})</small>
                      <div style="font-weight: bold; font-size: 14px; margin: 4px 0;">${m.home} vs ${m.away}</div>
                      <div style="font-size: 12px; color: var(--text-gray);">üìÖ ${new Date(m.date).toLocaleDateString("az-AZ")}</div>
                    </div>
                    <div style="text-align: right;">
                      <div style="font-size: 18px; font-weight: bold; color: var(--primary-green);">${m.s1} - ${m.s2}</div>
                    </div>
                  </div>
                </div>
              `,
          )
          .join("");
      }

      function renderTopGoals() {
        const list = document.getElementById("top-goals-list");
        const playerStats = players
          .map((p) => ({
            name: p.name,
            goals:
              Object.values(p.pastData).reduce(
                (sum, season) => sum + season.g,
                0,
              ) +
              Object.values(p.typeStats).reduce((sum, type) => sum + type.g, 0),
          }))
          .sort((a, b) => b.goals - a.goals)
          .slice(0, 5);

        if (playerStats.length === 0 || playerStats[0].goals === 0) {
          list.innerHTML =
            '<div style="text-align: center; color: var(--text-gray); padding: 20px;">H…ôl…ô qol yoxdur</div>';
          return;
        }

        list.innerHTML = playerStats
          .map(
            (p, idx) => `
            <div style="display: flex; align-items: center; margin-bottom: 8px;">
              <div style="width: 24px; height: 24px; background: var(--primary-green); color: #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 12px;">${idx + 1}</div>
              <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 14px;">${p.name}</div>
              </div>
              <div style="font-size: 16px; font-weight: bold; color: var(--gold);">${p.goals}</div>
            </div>
          `,
          )
          .join("");
      }

      function renderTopAssists() {
        const list = document.getElementById("top-assists-list");
        const playerStats = players
          .map((p) => ({
            name: p.name,
            assists:
              Object.values(p.pastData).reduce(
                (sum, season) => sum + season.a,
                0,
              ) +
              Object.values(p.typeStats).reduce((sum, type) => sum + type.a, 0),
          }))
          .sort((a, b) => b.assists - a.assists)
          .slice(0, 5);

        if (playerStats.length === 0 || playerStats[0].assists === 0) {
          list.innerHTML =
            '<div style="text-align: center; color: var(--text-gray); padding: 20px;">H…ôl…ô asist yoxdur</div>';
          return;
        }

        list.innerHTML = playerStats
          .map(
            (p, idx) => `
            <div style="display: flex; align-items: center; margin-bottom: 8px;">
              <div style="width: 24px; height: 24px; background: var(--primary-green); color: #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 12px;">${idx + 1}</div>
              <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 14px;">${p.name}</div>
              </div>
              <div style="font-size: 16px; font-weight: bold; color: var(--gold);">${p.assists}</div>
            </div>
          `,
          )
          .join("");
      }

      function viewProfile(index) {
        currentPlayerIndex = index;
        isEditMode = false;
        const p = players[index];

        // Sezon c…ôdv…ôli s…ôtirl…ôri (OM …ôlav…ô edildi)
        let seasonRows = seasonOptions
          .map(
            (s) =>
              `<tr>
      <td>${s}</td>
      <td>${isEditMode ? `<input type="number" id="season-om-${s.replace("/", "")}" value="${p.pastData[s].om || 0}" style="width:100%; border:none; background:none; color:inherit; text-align:center;" min="0">` : `${p.pastData[s].om || 0}`}</td> 
      <td>${isEditMode ? `<input type="number" id="season-g-${s.replace("/", "")}" value="${p.pastData[s].g}" style="width:100%; border:none; background:none; color:inherit; text-align:center;" min="0">` : `${p.pastData[s].g}`}</td>
      <td>${isEditMode ? `<input type="number" id="season-a-${s.replace("/", "")}" value="${p.pastData[s].a}" style="width:100%; border:none; background:none; color:inherit; text-align:center;" min="0">` : `${p.pastData[s].a}`}</td>
      <td>${isEditMode ? `<input type="number" id="season-m-${s.replace("/", "")}" value="${p.pastData[s].m}" style="width:100%; border:none; background:none; color:inherit; text-align:center;" min="0">` : `${p.pastData[s].m}`}</td>
    </tr>`,
          )
          .join("");

        // Mat√ß N√∂v√º c…ôdv…ôli s…ôtirl…ôri (OM …ôlav…ô edildi)
        let typeRows = matchTypes
          .map(
            (t) =>
              `<tr>
      <td>${t}</td>
      <td>${isEditMode ? `<input type="number" id="type-om-${t.replace(/\s+/g, "")}" value="${p.typeStats[t].om || 0}" style="width:100%; border:none; background:none; color:inherit; text-align:center;" min="0">` : `${p.typeStats[t].om || 0}`}</td>
      <td>${isEditMode ? `<input type="number" id="type-g-${t.replace(/\s+/g, "")}" value="${p.typeStats[t].g}" style="width:100%; border:none; background:none; color:inherit; text-align:center;" min="0">` : `${p.typeStats[t].g}`}</td>
      <td>${isEditMode ? `<input type="number" id="type-a-${t.replace(/\s+/g, "")}" value="${p.typeStats[t].a}" style="width:100%; border:none; background:none; color:inherit; text-align:center;" min="0">` : `${p.typeStats[t].a}`}</td>
      <td>${isEditMode ? `<input type="number" id="type-m-${t.replace(/\s+/g, "")}" value="${p.typeStats[t].m}" style="width:100%; border:none; background:none; color:inherit; text-align:center;" min="0">` : `${p.typeStats[t].m}`}</td>
    </tr>`,
          )
          .join("");

        changePage("player-profile", p.name);

        document.getElementById("profile-details").innerHTML = `
    <div class="stat-card rating-box" style="grid-column: span 2;">
      <div class="rating-value">${getOverall(p.stats)}</div>
      <div style="font-size:12px; opacity:0.7;">#${p.num} | Ya≈ü: ${p.age}</div>
    </div>

    <div class="season-table" style="grid-column: span 2;">
      <div class="table-title">üìÖ Sezon Statistikasƒ±</div>
      <table>
        <thead><tr><th>SEZON</th><th>OM</th><th>G</th><th>A</th><th>MOTM</th></tr></thead>
        <tbody>${seasonRows}</tbody>
      </table>
    </div>

    <div class="season-table" style="grid-column: span 2;">
      <div class="table-title">üèÜ Turnir/Mat√ß N√∂v√º</div>
      <table>
        <thead><tr><th>N√ñV</th><th>OM</th><th>G</th><th>A</th><th>MOTM</th></tr></thead>
        <tbody>${typeRows}</tbody>
      </table>
    </div>

    <div style="grid-column: span 2; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
      ${["Hƒ±z", "≈ûut", "Pas", "Dribling", "Defans", "Fizik"]
        .map(
          (n) => `
        <div class="stat-card single-stat" style="margin-bottom:0">
          <span style="font-size:10px; color:var(--text-gray)">${n.toUpperCase()}</span>
          ${isEditMode ? `<input type="number" id="profile-${n}" value="${p.stats?.[n] || 0}" style="font-size:18px; font-weight:bold; border:none; background:none; color:inherit; text-align:center; width:100%;" min="0" max="99">` : `<b style="font-size:18px">${p.stats?.[n] || 0}</b>`}
        </div>
      `,
        )
        .join("")}
    </div>

    ${
      isEditMode
        ? `<div style="grid-column: span 2; text-align: center; margin-top: 20px;">
      <button class="main-btn" onclick="saveProfileStats()">Yadda Saxla</button>
    </div>`
        : ""
    }`;
      }

      // Redakt…ô (Edit) b√∂lm…ôsind…ô d…ô OM giri≈ü sah…ôsi olmasƒ± √º√ß√ºn bu hiss…ôni d…ô yenil…ôyin:
      function openEditPage(idx) {
        const p = players[idx];
        changePage("edit-page", "Redakt…ô");

        let h = `<div class="form-group"><label>Ad</label><input type="text" id="edit-name" value="${p.name}"></div>
           <div class="form-group"><label>Ya≈ü</label><input type="number" id="edit-age" value="${p.age}"></div>
           <div class="form-group"><label>N√∂mr…ô</label><input type="text" id="edit-num" value="${p.num}"></div>`;

        statNames.forEach(
          (n) =>
            (h += `<div class="form-group"><label>${n}</label><input type="number" id="inp-${n}" value="${p.stats[n]}"></div>`),
        );
        document.getElementById("edit-form-container").innerHTML = h;

        let sH = "";
        seasonOptions.forEach((s) => {
          let data = p.pastData[s];
          let k = s.replace("/", "");
          sH += `<label style="font-size:9px; color:var(--text-gray);">${s}</label>
           <div class="edit-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
             <div><label>OM</label><input type="number" id="ps-om-${k}" value="${data.om || 0}"></div>
             <div><label>G</label><input type="number" id="ps-g-${k}" value="${data.g}"></div>
             <div><label>A</label><input type="number" id="ps-a-${k}" value="${data.a}"></div>
             <div><label>M</label><input type="number" id="ps-m-${k}" value="${data.m}"></div>
           </div>`;
        });
        document.getElementById("past-seasons-edit").innerHTML = sH;

        let tH = "";
        matchTypes.forEach((t) => {
          let data = p.typeStats[t];
          let k = t.replace(/\s+/g, "");
          tH += `<label style="font-size:9px; color:var(--text-gray);">${t}</label>
           <div class="edit-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
             <div><label>OM</label><input type="number" id="pt-om-${k}" value="${data.om || 0}"></div>
             <div><label>G</label><input type="number" id="pt-g-${k}" value="${data.g}"></div>
             <div><label>A</label><input type="number" id="pt-a-${k}" value="${data.a}"></div>
             <div><label>M</label><input type="number" id="pt-m-${k}" value="${data.m}"></div>
           </div>`;
        });
        document.getElementById("match-types-edit").innerHTML = tH;
      }

      function savePlayerStats() {
        const p = players[currentPlayerIndex];
        p.name = document.getElementById("edit-name").value || p.name;
        if (!p.name.trim()) {
          showToast("Ad bo≈ü ola bilm…ôz!", "error");
          return;
        }
        p.age = parseInt(document.getElementById("edit-age").value) || 0;
        p.num = document.getElementById("edit-num").value || p.num;

        if (p.age < 10 || p.age > 50) {
          showToast("Ya≈ü 10 il…ô 50 arasƒ±nda olmalƒ±dƒ±r!", "error");
          return;
        }

        statNames.forEach((n) => {
          const val = parseInt(document.getElementById("inp-" + n).value) || 0;
          p.stats[n] = Math.max(0, Math.min(99, val));
        });

        seasonOptions.forEach((s) => {
          let k = s.replace("/", "");
          p.pastData[s] = {
            g: Math.max(
              0,
              parseInt(document.getElementById(`ps-g-${k}`).value) || 0,
            ),
            a: Math.max(
              0,
              parseInt(document.getElementById(`ps-a-${k}`).value) || 0,
            ),
            m: Math.max(
              0,
              parseInt(document.getElementById(`ps-m-${k}`).value) || 0,
            ),
          };
        });

        matchTypes.forEach((t) => {
          let k = t.replace(/\s+/g, "");
          p.typeStats[t] = {
            om: Math.max(
              0,
              parseInt(document.getElementById(`pt-om-${k}`).value) || 0,
            ),
            g: Math.max(
              0,
              parseInt(document.getElementById(`pt-g-${k}`).value) || 0,
            ),
            a: Math.max(
              0,
              parseInt(document.getElementById(`pt-a-${k}`).value) || 0,
            ),
            m: Math.max(
              0,
              parseInt(document.getElementById(`pt-m-${k}`).value) || 0,
            ),
          };
        });

        localStorage.setItem("arena9_players", JSON.stringify(players));
        showToast("Oyun√ßu m…ôlumatƒ± g√ºnc…ôll…ôndi ‚úì", "success");
        viewProfile(currentPlayerIndex);
      }

      function saveProfileStats() {
        const p = players[currentPlayerIndex];

        // Save single stats
        ["Hƒ±z", "≈ûut", "Pas", "Dribling", "Defans", "Fizik"].forEach((n) => {
          const val =
            parseInt(document.getElementById(`profile-${n}`).value) || 0;
          p.stats[n] = Math.max(0, Math.min(99, val));
        });

        // Save season stats
        seasonOptions.forEach((s) => {
          let k = s.replace("/", "");
          p.pastData[s] = {
            om: Math.max(
              0,
              parseInt(document.getElementById(`season-om-${k}`).value) || 0,
            ),
            g: Math.max(
              0,
              parseInt(document.getElementById(`season-g-${k}`).value) || 0,
            ),
            a: Math.max(
              0,
              parseInt(document.getElementById(`season-a-${k}`).value) || 0,
            ),
            m: Math.max(
              0,
              parseInt(document.getElementById(`season-m-${k}`).value) || 0,
            ),
          };
        });

        // Save type stats
        matchTypes.forEach((t) => {
          let k = t.replace(/\s+/g, "");
          p.typeStats[t] = {
            om: Math.max(
              0,
              parseInt(document.getElementById(`type-om-${k}`).value) || 0,
            ),
            g: Math.max(
              0,
              parseInt(document.getElementById(`type-g-${k}`).value) || 0,
            ),
            a: Math.max(
              0,
              parseInt(document.getElementById(`type-a-${k}`).value) || 0,
            ),
            m: Math.max(
              0,
              parseInt(document.getElementById(`type-m-${k}`).value) || 0,
            ),
          };
        });

        localStorage.setItem("arena9_players", JSON.stringify(players));
        showToast("Profil statistikalarƒ± yadda saxlanƒ±ldƒ± ‚úì", "success");
        isEditMode = false;
        viewProfile(currentPlayerIndex);
        document.getElementById("edit-header-btn").innerHTML = "‚úèÔ∏è";
        document.getElementById("edit-header-btn").title = "Redakt…ô et";
      }

      function toggleEdit() {
        if (currentPage === "player-profile") {
          isEditMode = !isEditMode;
          viewProfile(currentPlayerIndex);
          document.getElementById("edit-header-btn").innerHTML = isEditMode
            ? "üíæ"
            : "‚úèÔ∏è";
          document.getElementById("edit-header-btn").title = isEditMode
            ? "Yadda Saxla"
            : "Redakt…ô et";
        } else if (currentPage === "maclar") {
          showMatchForm();
        } else if (currentPage === "oyuncular") {
          showAddPlayerForm();
        }
      }

      function showStats(type) {
        document
          .querySelectorAll(".tab-btn")
          .forEach((b) => b.classList.remove("active"));
        document.getElementById("btn-" + type).classList.add("active");

        let sorted = [...players]
          .map((p) => {
            let total = 0;
            seasonOptions.forEach((s) => {
              if (type === "gol") total += p.pastData[s].g;
              else if (type === "asist") total += p.pastData[s].a;
              else if (type === "motm") total += p.pastData[s].m;
            });
            return { name: p.name, val: total, num: p.num };
          })
          .filter((p) => p.val > 0)
          .sort((a, b) => b.val - a.val);

        if (sorted.length === 0) {
          document.getElementById("stats-list").innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">üìà</div>
              <div class="empty-state-text">H…ôl…ô statistika yoxdur</div>
            </div>
          `;
          return;
        }

        document.getElementById("stats-list").innerHTML = sorted
          .map(
            (p, i) => `
                <div class="rank-item">
                  <span class="rank-num">#${i + 1}</span>
                  <div style="flex:1">
                    <div style="font-weight:bold">${p.name}</div>
                    <div style="font-size:11px; color:#666">N√∂mr…ô: ${p.num}</div>
                  </div>
                  <div style="font-weight:bold; color:var(--primary-green); font-size:16px;">${p.val}</div>
                </div>
              `,
          )
          .join("");
      }

      function showAddPlayerForm() {
        changePage("add-player-page", "Yeni Oyun√ßu");
      }

      function showMatchForm() {
        changePage("add-match-page", "Yeni Mat√ß");
        tempEvents = [];
        s1 = 0;
        s2 = 0;
        updateScoreDisplay();
        updateTeamOptions();
        document.getElementById("player-datalist").innerHTML = players
          .map((p) => `<option value="${p.name}">`)
          .join("");
        document.getElementById("match_motm").innerHTML =
          `<option value="">Se√ßin...</option>` +
          players
            .map((p) => `<option value="${p.name}">${p.name}</option>`)
            .join("");
      }

      function updateTeamOptions() {
        const t1 = document.getElementById("m_home_team").value || "Ev";
        const t2 = document.getElementById("m_away_team").value || "Qonaq";
        document.getElementById("live-name-1").innerText = t1;
        document.getElementById("live-name-2").innerText = t2;
        document.getElementById("event_scoring_team").innerHTML =
          `<option value="${t1}">${t1}</option><option value="${t2}">${t2}</option>`;
      }

      function addMatchEvent() {
        const team = document.getElementById("event_scoring_team").value;
        const player = document
          .getElementById("event_player_manual")
          .value.trim();
        const assist = document
          .getElementById("event_assist_manual")
          .value.trim();

        if (!player) {
          showToast("Oyun√ßu adƒ±nƒ± daxil edin!", "error");
          return;
        }

        if (team === document.getElementById("m_home_team").value) s1++;
        else s2++;
        updateScoreDisplay();

        tempEvents.push({ team, player, assist: assist || null });
        document.getElementById("temp_event_list").innerHTML = `
          <div style="background: #111; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
            <div style="font-size: 12px; font-weight: bold; color: var(--primary-green); margin-bottom: 8px;">Qollar (${tempEvents.length}):</div>
            ${tempEvents
              .map(
                (
                  e,
                  i,
                ) => `<div style="font-size: 11px; padding: 4px 0; color: #ccc;">
                  ‚öΩ <b>${e.team}:</b> ${e.player} ${e.assist ? "<small style='color:#888'>(A: " + e.assist + ")</small>" : ""}
                  <button class="btn-danger" style="float: right; padding: 2px 6px; font-size: 9px;" onclick="removeTempEvent(${i})">Sil</button>
                </div>`,
              )
              .join("")}
          </div>
        `;
        document.getElementById("event_player_manual").value = "";
        document.getElementById("event_assist_manual").value = "";
        showToast("Qol …ôlav…ô edildi ‚úì", "success");
      }

      function removeTempEvent(idx) {
        tempEvents.splice(idx, 1);
        if (tempEvents.length === 0) {
          s1 = 0;
          s2 = 0;
        }
        updateScoreDisplay();
        addMatchEvent();
        document.getElementById("event_player_manual").value = "";
        document.getElementById("event_assist_manual").value = "";
      }

      function updateScoreDisplay() {
        document.getElementById("live-s1").innerText = s1;
        document.getElementById("live-s2").innerText = s2;
      }

      function saveMatch() {
        if (!validateMatchForm()) return;

        const match = {
          id: Date.now(),
          type: document.getElementById("m_type").value,
          home: document.getElementById("m_home_team").value.trim(),
          away: document.getElementById("m_away_team").value.trim(),
          s1,
          s2,
          date: document.getElementById("m_date_time").value,
          season: document.getElementById("m_season").value,
          motm: document.getElementById("match_motm").value,
          events: [...tempEvents],
        };

        const s = match.season;
        const t = match.type;

        match.events.forEach((ev) => {
          let pIdx = players.findIndex((p) => p.name === ev.player);
          if (pIdx !== -1) {
            players[pIdx].pastData[s].g++;
            players[pIdx].typeStats[t].g++;
          }
          let aIdx = players.findIndex((p) => p.name === ev.assist);
          if (aIdx !== -1) {
            players[aIdx].pastData[s].a++;
            players[aIdx].typeStats[t].a++;
          }
        });

        if (match.motm) {
          let mIdx = players.findIndex((p) => p.name === match.motm);
          if (mIdx !== -1) {
            players[mIdx].pastData[s].m++;
            players[mIdx].typeStats[t].m++;
          }
        }

        matches.unshift(match);
        localStorage.setItem("arena9_matches", JSON.stringify(matches));
        localStorage.setItem("arena9_players", JSON.stringify(players));
        showToast("Mat√ß uƒüurla saxlanƒ±ldƒ±! ‚úì", "success");
        changePage("maclar", "Mat√ßlar");
      }

      function renderMatches() {
        const list = document.getElementById("match-list");

        if (matches.length === 0) {
          list.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">‚öΩ</div>
              <div class="empty-state-text">H…ôl…ô mat√ß yoxdur</div>
              <div style="margin-top: 15px;">
                <button class="main-btn" style="max-width: 200px; margin: 0 auto;" onclick="showMatchForm()">
                  + Yeni Mat√ß
                </button>
              </div>
            </div>
          `;
          return;
        }

        matches.sort((a, b) => new Date(b.date) - new Date(a.date));
        list.innerHTML = matches
          .map(
            (m, idx) => `
                <div class="match-card" onclick="viewMatch(${idx})" style="cursor: pointer;">
                  <div class="card-header">
                    <small style="color:var(--primary-green)">${m.type} (${m.season})</small>
                    <button class="btn-danger" onclick="deleteMatch(${idx}, event)">üóëÔ∏è Sil</button>
                  </div>
                  <div style="display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; font-weight: bold; margin: 10px 0; font-size: 18px;">
                    <span style="text-align: left; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${m.home}</span>
                    <span style="color: var(--primary-green); text-align: center;">${m.s1} - ${m.s2}</span>
                    <span style="text-align: right; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${m.away}</span>
                  </div>
                  <div style="font-size: 12px; color: var(--text-gray); margin-bottom: 8px;">
                    üìÖ ${new Date(m.date).toLocaleDateString("az-AZ")}
                  </div>
                </div>
              `,
          )
          .join("");
      }

      function deleteMatch(idx, event) {
        event.stopPropagation();
        const match = matches[idx];
        showConfirm(
          `${match.home} - ${match.away} mat√ßƒ± silinsin?\nBu …ôm…ôl geri qaytarƒ±la bilm…ôz.`,
          () => {
            matches.splice(idx, 1);
            localStorage.setItem("arena9_matches", JSON.stringify(matches));
            showToast("Mat√ß silindi", "success");
            renderMatches();
          },
        );
      }

      function viewMatch(idx) {
        const match = matches[idx];
        document.getElementById("modal-title").innerText =
          `${match.home} vs ${match.away}`;
        document.getElementById("modal-content").innerHTML = `
          <!-- Match Header -->
          <div style="background: linear-gradient(135deg, var(--card-gray) 0%, var(--bg-dark) 100%); padding: 24px; border-radius: 16px; margin-bottom: 24px; box-shadow: var(--shadow);">
            <div style="text-align: center; margin-bottom: 20px;">
              <div style="font-size: 14px; color: var(--text-gray); margin-bottom: 8px;">${match.type} ‚Ä¢ ${match.season}</div>
              <div style="font-size: 12px; color: var(--text-gray);">üìÖ ${new Date(match.date).toLocaleString("az-AZ")}</div>
            </div>
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
              <div style="text-align: center; flex: 1;">
                <div style="font-size: 20px; font-weight: 700; color: var(--text-light); margin-bottom: 8px;">${match.home}</div>
                <div style="width: 60px; height: 60px; background: var(--primary-green); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto; font-size: 24px; font-weight: bold; color: #000;">üèÜ</div>
              </div>
              
              <div style="text-align: center; padding: 0 20px;">
                <div style="font-size: 48px; font-weight: 900; color: var(--primary-green); line-height: 1; margin-bottom: 8px;">${match.s1} - ${match.s2}</div>
                <div style="font-size: 12px; color: var(--text-gray); text-transform: uppercase;">FT</div>
              </div>
              
              <div style="text-align: center; flex: 1;">
                <div style="font-size: 20px; font-weight: 700; color: var(--text-light); margin-bottom: 8px;">${match.away}</div>
                <div style="width: 60px; height: 60px; background: var(--primary-green); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto; font-size: 24px; font-weight: bold; color: #000;">‚öΩ</div>
              </div>
            </div>
          </div>
          
          <!-- Events Timeline -->
          <div style="background: var(--card-gray); padding: 24px; border-radius: 16px; margin-bottom: 24px;">
            <h3 style="color: var(--primary-green); margin-bottom: 20px; font-size: 18px; font-weight: 600;">‚öΩ Hadis…ôl…ôr</h3>
            ${
              match.events.length > 0
                ? `
              <div style="position: relative;">
                <div style="position: absolute; left: 50%; top: 0; bottom: 0; width: 2px; background: var(--primary-green); transform: translateX(-50%);"></div>
                ${match.events
                  .map(
                    (e, i) => `
                  <div style="display: flex; align-items: center; margin-bottom: 16px; ${i % 2 === 0 ? "justify-content: flex-start;" : "justify-content: flex-end; flex-direction: row-reverse;"}">
                    <div style="background: ${e.team === match.home ? "var(--primary-green)" : "var(--danger-red)"}; color: #000; padding: 8px 12px; border-radius: 20px; font-weight: 600; font-size: 14px; z-index: 1;">
                      ‚öΩ ${e.player}
                      ${e.assist ? ` (A: ${e.assist})` : ""}
                    </div>
                  </div>
                `,
                  )
                  .join("")}
              </div>
            `
                : '<div style="text-align: center; color: var(--text-gray); padding: 40px 0;">Qol yoxdur</div>'
            }
          </div>
          
          <!-- Match Stats -->
          <div style="background: var(--card-gray); padding: 24px; border-radius: 16px; margin-bottom: 24px;">
            <h3 style="color: var(--primary-green); margin-bottom: 20px; font-size: 18px; font-weight: 600;">üìä Statistika</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
              <div style="text-align: center;">
                <div style="font-size: 24px; font-weight: bold; color: var(--text-light);">${match.events.filter((e) => e.team === match.home).length}</div>
                <div style="font-size: 12px; color: var(--text-gray);">${match.home} Qollarƒ±</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 24px; font-weight: bold; color: var(--text-light);">${match.events.filter((e) => e.team === match.away).length}</div>
                <div style="font-size: 12px; color: var(--text-gray);">${match.away} Qollarƒ±</div>
              </div>
            </div>
          </div>
          
          <!-- Man of the Match -->
          <div style="background: var(--card-gray); padding: 24px; border-radius: 16px;">
            <h3 style="color: var(--primary-green); margin-bottom: 20px; font-size: 18px; font-weight: 600;">‚≠ê Man of the Match</h3>
            <div style="display: flex; align-items: center;">
              <div style="width: 50px; height: 50px; background: var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 16px; font-size: 20px;">‚≠ê</div>
              <div>
                <div style="font-size: 18px; font-weight: 600; color: var(--gold);">${match.motm || "Se√ßilm…ôdi"}</div>
                <div style="font-size: 12px; color: var(--text-gray);">∆èn yax≈üƒ± oyun√ßu</div>
              </div>
            </div>
          </div>
        `;
        document.getElementById("match-modal").style.display = "block";
      }

      function closeMatchModal() {
        document.getElementById("match-modal").style.display = "none";
      }

      function renderComparison() {
        compareLeft = null;
        compareRight = null;
        document.getElementById("player1-select").innerHTML = `
          <div class="select-icon">+</div>
          <div class="select-text">Oyuncu Se√ß</div>
        `;
        document.getElementById("player2-select").innerHTML = `
          <div class="select-icon">+</div>
          <div class="select-text">Oyuncu Se√ß</div>
        `;
        document.getElementById("comparison-content").style.display = "none";
      }

      function selectPlayer(side) {
        currentCompareSide = side;
        const modalContent = `
          <div style="max-height: 400px; overflow-y: auto;">
            ${players
              .map(
                (p, i) => `
              <div onclick="choosePlayer(${i})" style="padding: 12px; border-bottom: 1px solid var(--card-gray); cursor: pointer; display: flex; align-items: center; gap: 10px;">
                <div style="width: 40px; height: 40px; background: var(--primary-green); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #000; font-weight: bold;">${p.num}</div>
                <div>
                  <div style="font-weight: bold;">${p.name}</div>
                  <div style="font-size: 12px; color: var(--text-gray);">N√∂mr…ô: ${p.num}</div>
                </div>
              </div>
            `,
              )
              .join("")}
          </div>
        `;
        document.getElementById("modal-title").innerText = "Oyuncu Se√ß";
        document.getElementById("modal-content").innerHTML = modalContent;
        document.getElementById("match-modal").style.display = "flex";
      }

      function choosePlayer(index) {
        const player = players[index];
        if (currentCompareSide === 1) {
          compareLeft = player;
          document.getElementById("player1-select").innerHTML = `
            <div style="width: 60px; height: 60px; background: var(--primary-green); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #000; font-weight: bold; font-size: 24px; margin-bottom: 5px;">${player.num}</div>
            <div style="font-weight: bold; font-size: 14px; text-align: center;">${player.name}</div>
          `;
        } else {
          compareRight = player;
          document.getElementById("player2-select").innerHTML = `
            <div style="width: 60px; height: 60px; background: var(--primary-green); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #000; font-weight: bold; font-size: 24px; margin-bottom: 5px;">${player.num}</div>
            <div style="font-weight: bold; font-size: 14px; text-align: center;">${player.name}</div>
          `;
        }
        closeMatchModal();
        if (compareLeft && compareRight) {
          updateComparison();
        }
      }

      function updateComparison() {
        const technicalStats = [
          { name: "Hƒ±z", key: "Hƒ±z" },
          { name: "≈ûut", key: "≈ûut" },
          { name: "Pas", key: "Pas" },
          { name: "Dribling", key: "Dribling" },
          { name: "Defans", key: "Defans" },
          { name: "Fizik", key: "Fizik" },
        ];

        const performanceStats = [
          { name: "Qollar", key: "goals" },
          { name: "Asistl…ôr", key: "assists" },
          { name: "Oynadƒ±ƒüƒ± Mat√ßlar", key: "matches" },
          { name: "Qol/Mat√ß", key: "avg" },
        ];

        const leftStats = calculatePlayerStats(compareLeft);
        const rightStats = calculatePlayerStats(compareRight);

        const technicalNamesHtml = technicalStats
          .map((stat) => `<div class="stat-item">${stat.name}</div>`)
          .join("");
        const performanceNamesHtml = performanceStats
          .map((stat) => `<div class="stat-item">${stat.name}</div>`)
          .join("");

        const leftTechnicalHtml = technicalStats
          .map((stat) => {
            const diff = leftStats[stat.key] - rightStats[stat.key];
            const diffHtml =
              diff > 0 ? `<span class="stat-diff">+${diff}</span>` : "";
            return `<div class="stat-item">${leftStats[stat.key]} ${diffHtml}</div>`;
          })
          .join("");

        const rightTechnicalHtml = technicalStats
          .map((stat) => {
            const diff = rightStats[stat.key] - leftStats[stat.key];
            const diffHtml =
              diff > 0 ? `<span class="stat-diff">+${diff}</span>` : "";
            return `<div class="stat-item">${rightStats[stat.key]} ${diffHtml}</div>`;
          })
          .join("");

        const leftPerformanceHtml = performanceStats
          .map((stat) => {
            const diff = leftStats[stat.key] - rightStats[stat.key];
            const diffHtml =
              diff > 0 ? `<span class="stat-diff">+${diff}</span>` : "";
            return `<div class="stat-item">${leftStats[stat.key]} ${diffHtml}</div>`;
          })
          .join("");

        const rightPerformanceHtml = performanceStats
          .map((stat) => {
            const diff = rightStats[stat.key] - leftStats[stat.key];
            const diffHtml =
              diff > 0 ? `<span class="stat-diff">+${diff}</span>` : "";
            return `<div class="stat-item">${rightStats[stat.key]} ${diffHtml}</div>`;
          })
          .join("");

        document.querySelector(".stat-names").innerHTML = `
          ${technicalNamesHtml}
          <div style="height: 40px;"></div>
          ${performanceNamesHtml}
        `;

        document.getElementById("player1-stats").innerHTML = `
          ${leftTechnicalHtml}
          <div style="height: 40px;"></div>
          ${leftPerformanceHtml}
        `;

        document.getElementById("player2-stats").innerHTML = `
          ${rightTechnicalHtml}
          <div style="height: 40px;"></div>
          ${rightPerformanceHtml}
        `;

        document.getElementById("comparison-content").style.display = "block";
      }

      function calculatePlayerStats(player) {
        let goals = 0;
        let assists = 0;
        let matchSet = new Set();
        matches.forEach((match) => {
          match.events.forEach((event) => {
            if (event.player === player.name) {
              goals++;
              matchSet.add(match.date + match.home + match.away);
            }
            if (event.assist === player.name) {
              assists++;
            }
          });
        });
        const matchesPlayed = matchSet.size;
        const avg = matchesPlayed > 0 ? (goals / matchesPlayed).toFixed(2) : 0;
        return {
          goals,
          assists,
          matches: matchesPlayed,
          avg,
          Hƒ±z: player.stats?.Hƒ±z || 0,
          ≈ûut: player.stats?.≈ûut || 0,
          Pas: player.stats?.Pas || 0,
          Dribling: player.stats?.Dribling || 0,
          Defans: player.stats?.Defans || 0,
          Fizik: player.stats?.Fizik || 0,
        };
      }

      window.onload = () => {
        changePage("ana-sayfa", "∆èsas");
      };
    </script>

    <!-- Match Detail Modal -->
    <div
      id="match-modal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        z-index: 1000;
        overflow-y: auto;
      "
    >
      <div style="max-width: 800px; margin: 0 auto; padding: 20px">
        <div
          style="
            background: var(--bg-black);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow);
          "
        >
          <div
            style="
              padding: 20px;
              background: var(--card-gray);
              display: flex;
              justify-content: space-between;
              align-items: center;
            "
          >
            <h2
              id="modal-title"
              style="margin: 0; color: var(--primary-green); margin-right: 10px"
            >
              Mat√ß Detallarƒ±
            </h2>
            <button
              onclick="closeMatchModal()"
              style="
                background: var(--danger-red);
                color: white;
                border: none;
                padding: 8px 12px;
                border-radius: 8px;
                cursor: pointer;
              "
            >
              ‚úï Baƒüla
            </button>
          </div>
          <div id="modal-content" style="padding: 24px"></div>
        </div>
      </div>
    </div>
  </body>
</html>
